x32dbg Ã¨ un debugger che permette di analizzare il comportamento del malware **run-time**.

Analizzaremo `Lab-09-02`

---

x32dbg pone il primo bp sul system bp, esso si attiva quando il loader ha finito di caricare tutte le dll che il malware usa; un secondo bp si setta sull'entry bp, ovvero sulla prima istruzione della sezione `.text`.

Si possono eseguire diverse operazioni, e.g. `execute till return`, per eseguire direttamente fino all'istruzione return della funzione si sta debuggando, ...

L'interfaccia si divide in diverse finestre:
- codice dell'eseguibile (se si preme `G` si puÃ² visualizzare graficamente i jump, control flow graph)
- visualizzazione registri, si possono modificare i registri
- vista dello stack
- infine abbiamo i diversi memory dump, per visualizzare il contenuto di una specifica area di memoria di interesse

Per visualizzare le cross-references: search > current module > intermodulars calls

>[!info] SUCA BIANCO

Setting dei bp, ci sono 4 tipologie:
- sw bp, "basta cliccare F2". Lo svantaggio Ã¨ che l'istruzione che breakkiamo viene sostituita con un `int 3`, ciÃ² permette di implementare tecniche di anti-debugging
- hw bp, usano dei registri DR0 - DR7 (4 bp contemporaneamente)
- memory bp, per analizzare i dump di memoria

Modifica delle istruzioni, Ã¨ possibile modificare una jump, per esempio, per modificare il flow d'esecuzione: `right click > binary > edit/assemble`.
Premere sul ðŸ©¹ per vedere tutte le modifiche, restorarle oppure patchare il file.

---

Apriamo rundll32.dll (sotto System32), poi andiamo su file > change command line ed inseriamo la seguente stringa
`"...\Chapter_9L\DLL1.dll,DLL1.Print"`.
Poi aggiungere `dll1.print` nei breakpoints.