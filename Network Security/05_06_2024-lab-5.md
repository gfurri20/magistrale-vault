Si vedrà un tool utile per effettuare attacchi automatici alle PLC industriali.

# Attacchi alle PLC

I tre grandi obiettivi di un attacco i
- general damage - tenta di distruggere del tutto i processi industriali
- performance damage - tenta di abbassare le performance dei processi industriali (e.g. produzione più lenta)
- work incorrectly - tenta di eseguire comportamenti che potrebbero fare danni all'azienda in generale (e.g. magari per aumentare il tasso di inquinamento)

Vedremo l'effetto del tool, sulla prima PLC dello schema.

Il tool permette di eseguire diversi attack (e di specificare diverse opzioni):
- **mitm** - un server modbus si finge la PLC, in questo modo l'HMI mostrerà valori sporchi offerti dal server malevolo
	- è utile impostare dei trigger ovvero degli stati/eventi che permettano i far partire l'attacco nel momento interessato
- **DOS** - denial of service alle PLC in modo da bombardarle di pacchetti
	- si possono specificare i target con la porta
	- decidere il numero di pacchetti da inviare
- **Chattering** - permette di accendere e spegnere molto velocemente una valvola o un attuatore, quindi consente di rovinare il dispositivo bersaglio cercando, però, di mantenere attivo il sistema
	- il tool non presenta GUI

---

## DoS
Se la PLC è running abbiamo che uno specifico registro di memoria è impostato:
- `FALSE` - se la pompa è spenta
- `TRUE` - se la pompa è accesa

Noi vogliamo eseguire **un attacco DOS** sulla PLC per far finta che sia necessario accendere la pompa, mandando continuamente messaggi di avviso **che aggiornano il registro read-only**.

DOS ha una frequenza maggiore di ScanCycle rispetto al numero di pacchetti inviati al secondo.

Il registro della PLC "sfarfalla" quando avviene l'attacco DOS perché si scontra con la logica della PLC, ovvero il programma che rivela l'altezza dell'acqua attraverso un sensore di livello fisico che immette lo stato attuale della cisterna in un registro read-only per il programma.

Lo stato letto viene analizzato dalla **process image** che permette poi ti tradurre le informazioni in voltaggio per l'attuatore.

Appena l'attacco si stoppa il circuito riprende la corretta esecuzione.

---

